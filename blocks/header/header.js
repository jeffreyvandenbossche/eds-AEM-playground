import { getMetadata } from '../../scripts/aem.js';
import { loadFragment } from '../fragment/fragment.js';

/**
 * loads and decorates the header, mainly the nav
 * @param {Element} block The header block element
 */
export default async function decorate(block) {
  // Load nav fragment (keep this for potential future use)
  const navMeta = getMetadata('nav');
  const navPath = navMeta ? new URL(navMeta, window.location).pathname : '/nav';
  await loadFragment(navPath);

  // Clear existing content
  block.textContent = '';

  // Create custom bs-header-navigation element
  const bsHeader = document.createElement('bs-header-navigation');
  bsHeader.setAttribute('header-navigation', '{"mainLogo":{"src":"https://s7g10.scene7.com/is/content/bridgestoneeu/bridgestone-solutions-for-your-journey","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"mobileMainLogo":{"src":"https://s7g10.scene7.com/is/content/bridgestoneeu/B-mark-logo","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"stickyLogo":{"src":"https://s7g10.scene7.com/is/content/bridgestoneeu/bridgestone-solutions-for-your-journey","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"stickyButton":null,"navigation":{"primary":[{"href":null,"title":"Our Company","target":null,"description":null,"thumbnail":null,"children":[{"href":"/our-company/about.html","title":"About","target":null,"description":null,"thumbnail":null,"children":null},{"href":"/our-company/sustainability.html","title":"Sustainability","target":null,"description":null,"thumbnail":null,"children":null},{"href":"/our-company/carreers.html","title":"Careers","target":null,"description":null,"thumbnail":null,"children":null},{"href":"/our-company/enliten.html","title":"ENLITEN","target":null,"description":null,"thumbnail":null,"children":null},{"href":"/our-company/driveguard.html","title":"DriveGuard","target":null,"description":null,"thumbnail":null,"children":null}]},{"href":"/press.html","title":"Press","target":null,"description":null,"thumbnail":null,"children":null},{"href":null,"title":"Promotions","target":null,"description":null,"thumbnail":null,"children":[{"href":"/promotions/Bridgestone-Rewards.html","title":"Bridgestone Rewards","target":null,"description":null,"thumbnail":null,"children":null}]},{"href":null,"title":"Stories","target":null,"description":null,"thumbnail":null,"children":[{"href":"/stories/our-people-and-partners.html","title":"Our People and Partners Stories","target":null,"description":null,"thumbnail":null,"children":null},{"href":"/stories/sustainability.html","title":"Sustainability","target":null,"description":null,"thumbnail":null,"children":null}]},{"href":"/contact-us.html","title":"Contact Us","target":null,"description":null,"thumbnail":null,"children":null}],"secondary":[{"href":null,"title":"Our Products","target":null,"description":null,"thumbnail":null,"children":[{"href":"/our-products/car-tyres.html","title":"Car & 4x4 tyres","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/car-tyres.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-products/motorcycle-tyres.html","title":"Motorcycle tyres","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/motorcycle-tyres.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-products/agricultural.html","title":"Agricultural tyres","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/agricultural.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-products/off-the-road.html","title":"Off the road tyres","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/off-the-road.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-products/truck-and-bus.html","title":"Truck and bus tyres","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/truck-and-bus.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-products/retread.html","title":"Retread","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-products/retread.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null}]},{"href":null,"title":"Our Solutions","target":null,"description":null,"thumbnail":null,"children":[{"href":"/our-solutions/webfleet.html","title":"Webfleet","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-solutions/webfleet.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null},{"href":"/our-solutions/fleetcare.html","title":"Bridgestone Fleet Care","target":null,"description":null,"thumbnail":{"src":"/content/bridgestone/gb/en/home-page/our-solutions/fleetcare.thumb.300.300.png","srcset":null,"imageSizes":null,"altText":null,"caption":null,"cover":false,"width":0,"height":0,"lazy":false,"empty":false},"children":null}]}],"sliderItems":[{"href":"/motorcycle-tyres/sport/battlax-s23.html","title":"NEW Battlax Hypersport S23","target":null,"description":"Experience the new benchmark in the motorcycle hypersport segment. The Bridgestone Battlax Hypersport S23 will take your riding to the next level ","thumbnail":{"src":"https://s7g10.scene7.com/is/image/bridgestoneeu/2023_BSEU_S23_JPG_A_DetailDry-003","srcset":"https://s7g10.scene7.com/is/image/bridgestoneeu/2023_BSEU_S23_JPG_A_DetailDry-003:RATIO-16-9-MOBILE 400w, https://s7g10.scene7.com/is/image/bridgestoneeu/2023_BSEU_S23_JPG_A_DetailDry-003:RATIO-16-9-TABLET 1200w, https://s7g10.scene7.com/is/image/bridgestoneeu/2023_BSEU_S23_JPG_A_DetailDry-003:RATIO-16-9-DESKTOP 1440w, https://s7g10.scene7.com/is/image/bridgestoneeu/2023_BSEU_S23_JPG_A_DetailDry-003:RATIO-16-9-DESKTOP-LARGE 1920w","imageSizes":"1920px, 1440px, 1200px, 400px","altText":null,"caption":null,"cover":false,"width":768,"height":432,"lazy":false,"empty":false},"children":null},{"href":"/car-tyres/summer-tyres-turanza/turanza-all-season-6.html","title":"Turanza All Season 6","target":null,"description":"Drive without hesitation, even when facing rain or occasional snow. Whatever the season, Turanza All Season 6 ensures safety & control","thumbnail":{"src":"https://s7g10.scene7.com/is/image/bridgestoneeu/Turanza-6-product-pictures-bottom-center-1","srcset":"https://s7g10.scene7.com/is/image/bridgestoneeu/Turanza-6-product-pictures-bottom-center-1:RATIO-16-9-MOBILE 400w, https://s7g10.scene7.com/is/image/bridgestoneeu/Turanza-6-product-pictures-bottom-center-1:RATIO-16-9-TABLET 1200w, https://s7g10.scene7.com/is/image/bridgestoneeu/Turanza-6-product-pictures-bottom-center-1:RATIO-16-9-DESKTOP 1440w, https://s7g10.scene7.com/is/image/bridgestoneeu/Turanza-6-product-pictures-bottom-center-1:RATIO-16-9-DESKTOP-LARGE 1920w","imageSizes":"1920px, 1440px, 1200px, 400px","altText":null,"caption":null,"cover":false,"width":768,"height":432,"lazy":false,"empty":false},"children":null}]}}');

  // Create a wrapper for the custom header
  const navWrapper = document.createElement('div');
  navWrapper.className = 'nav-wrapper';
  navWrapper.append(bsHeader);
  block.append(navWrapper);

  // Add a class to indicate we're using the custom header
  block.classList.add('bs-custom-header');
}
